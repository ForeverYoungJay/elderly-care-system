# Module Requirements and Workflows

## 1. Core: Organization, Staff, Resident, Bed
### Organization
- Hierarchy: CAMPUS > BUILDING > FLOOR > DEPT
- Fields: id, name, type, parentId, status
- Rules: parentId must exist unless type=CAMPUS; cannot delete if has children

### Staff
- Fields: id, name, username, phone, roles[], orgId, status
- Rules: username unique per tenant; password hashed; staff can have multiple roles

### Resident
- Fields: id, name, gender, birthday, roomNo, bedId, emergency contact, chronic diseases, allergies, diet taboo
- Rules: cannot assign two residents to same bed; discharge closes all active tasks

### Bed
- Fields: id, roomNo, bedNo, orgId, status (AVAILABLE, OCCUPIED, MAINTENANCE)
- Rules: change to OCCUPIED when resident assigned; cannot delete if occupied

## 2. Safety Services
### Entities
- InspectionPlan: name, scope, frequency, checklist, owner, schedule
- InspectionTask: planId, assignee, dueAt, status
- Incident: taskId, severity, description, attachments
- WorkOrder: incidentId, owner, status, resolution

### Workflow
1) Plan created and scheduled
2) Tasks generated by schedule
3) Staff executes task, records results
4) If failed -> incident created
5) Work order created, assigned
6) Resolution and verification
7) Closure and KPI update

### Statuses
- Task: PENDING, IN_PROGRESS, DONE, FAILED, OVERDUE
- Incident: OPEN, IN_PROGRESS, RESOLVED, CLOSED
- WorkOrder: OPEN, ASSIGNED, FIXED, VERIFIED, CLOSED

### SLAs
- High severity incident response within 2 hours
- Closure within 24 hours

## 3. Medical Services
### Entities
- HealthRecord: residentId, baseline vitals, medical history
- Evaluation: type (initial/periodic), score, notes
- Vitals: bp, temp, pulse, oxygen, capturedAt
- ChronicPlan: disease, plan, target metrics
- MonthlyCheck: summary, physician notes
- SemiAnnualReport: aggregated report PDF

### Workflow
- Admission creates HealthRecord
- Periodic evaluation schedule
- Vitals ingested daily/weekly
- Monthly check produces report
- Semi-annual report is generated and archived

## 4. Diet Services
### Entities
- Menu: date, mealType (BREAKFAST/LUNCH/DINNER/TEA), items
- SpecialDietOrder: residentId, condition, restriction, startAt, endAt
- MealDispatch: menuId, residentId, status, deliveredAt

### Workflow
- Dietitian creates weekly menus
- Special diets defined per resident
- Kitchen prints production list
- Delivery recorded, exceptions logged

## 5. Nursing Services
### Entities
- ServiceItem: name, category, duration, defaultSLA
- ServiceTask: itemId, residentId, assignee, status
- ServiceRecord: taskId, notes, attachments
- Attendance: staffId, checkIn, checkOut, location
- LeaveRequest: staffId, type, reason, status
- Audit: recordId, auditorId, score, notes

### Workflow
- Daily tasks generated by care plan
- Nurse completes task and records service
- Supervisor audits samples
- Attendance auto-summary for payroll

## 6. Administration and RBAC
- Roles with permissions and scope (orgId)
- Default roles: DIRECTOR, NURSE_LEAD, NURSE, DOCTOR, DIETITIAN, SAFETY_OFFICER, ADMIN
- Permission examples: MEDICAL_READ, MEDICAL_WRITE, DIET_PLAN_WRITE

## 7. External Agency Reporting
- ReportJob: agency, period, status, payload
- Receipt: jobId, code, message, receivedAt
- Retry policy: exponential backoff, max 5
- Manual re-submit tool

## 8. Reporting and Analytics
- Dashboards: safety incidents, nursing SLA, medical compliance
- Exports: CSV/Excel
- Scheduled reports delivered to director and admin
